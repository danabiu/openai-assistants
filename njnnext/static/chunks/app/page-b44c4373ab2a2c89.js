(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{1551:function(e,t,a){Promise.resolve().then(a.bind(a,6911))},819:function(e,t,a){"use strict";var s=a(7437),n=a(2265),i=a(1438),r=a.n(i),l=a(8165),c=a(6566);let o=e=>{let{text:t}=e;return(0,s.jsx)("div",{className:r().userMessage,children:t})},u=e=>{let{text:t}=e;return(0,s.jsx)("div",{className:r().assistantMessage,children:(0,s.jsx)(c.U,{children:t})})},d=e=>{let{text:t}=e;return(0,s.jsx)("div",{className:r().codeMessage,children:t.split("\n").map((e,t)=>(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{children:"".concat(t+1,". ")}),e]},t))})},_=e=>{let{role:t,text:a}=e;switch(t){case"user":return(0,s.jsx)(o,{text:a});case"assistant":return(0,s.jsx)(u,{text:a});case"code":return(0,s.jsx)(d,{text:a});default:return null}};t.Z=e=>{let{functionCallHandler:t=()=>Promise.resolve("")}=e,[a,i]=(0,n.useState)(""),[c,o]=(0,n.useState)([]),[u,d]=(0,n.useState)(!1),[h,p]=(0,n.useState)(""),m=(0,n.useRef)(null),x=()=>{var e;null===(e=m.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})};(0,n.useEffect)(()=>{x()},[c]),(0,n.useEffect)(()=>{(async()=>{let e=await fetch("/api/assistants/threads",{method:"POST"});p((await e.json()).threadId)})()},[]);let f=async e=>{let t=await fetch("/api/assistants/threads/".concat(h,"/messages"),{method:"POST",body:JSON.stringify({content:e})});S(l.c.fromReadableStream(t.body))},v=async(e,t)=>{let a=await fetch("/api/assistants/threads/".concat(h,"/actions"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({runId:e,toolCallOutputs:t})});S(l.c.fromReadableStream(a.body))},g=()=>{M("assistant","")},j=e=>{null!=e.value&&E(e.value),null!=e.annotations&&O(e.annotations)},b=e=>{E("\n![".concat(e.file_id,"](/api/files/").concat(e.file_id,")\n"))},y=e=>{"code_interpreter"==e.type&&M("code","")},N=(e,t)=>{"code_interpreter"==e.type&&e.code_interpreter.input&&E(e.code_interpreter.input)},C=async e=>{let a=e.data.id,s=e.data.required_action.submit_tool_outputs.tool_calls,n=await Promise.all(s.map(async e=>({output:await t(e),tool_call_id:e.id})));d(!0),v(a,n)},w=()=>{d(!1)},S=e=>{e.on("textCreated",g),e.on("textDelta",j),e.on("imageFileDone",b),e.on("toolCallCreated",y),e.on("toolCallDelta",N),e.on("event",e=>{"thread.run.requires_action"===e.event&&C(e),"thread.run.completed"===e.event&&w()})},E=e=>{o(t=>{let a=t[t.length-1],s={...a,text:a.text+e};return[...t.slice(0,-1),s]})},M=(e,t)=>{o(a=>[...a,{role:e,text:t}])},O=e=>{o(t=>{let a={...t[t.length-1]};return e.forEach(e=>{"file_path"===e.type&&(a.text=a.text.replaceAll(e.text,"/api/files/".concat(e.file_path.file_id)))}),[...t.slice(0,-1),a]})};return(0,s.jsxs)("div",{className:r().chatContainer,children:[(0,s.jsxs)("div",{className:r().messages,children:[c.map((e,t)=>(0,s.jsx)(_,{role:e.role,text:e.text},t)),(0,s.jsx)("div",{ref:m})]}),(0,s.jsxs)("form",{onSubmit:e=>{e.preventDefault(),a.trim()&&(f(a),o(e=>[...e,{role:"user",text:a}]),i(""),d(!0),x())},className:"".concat(r().inputForm," ").concat(r().clearfix),children:[(0,s.jsx)("input",{type:"text",className:r().input,value:a,onChange:e=>i(e.target.value),placeholder:"Env\xeda un mensaje al Asistente de Tecnoiglesia"}),(0,s.jsx)("button",{type:"submit",className:r().button,disabled:u,children:"Enviar"})]})]})}},6911:function(e,t,a){"use strict";a.r(t);var s=a(7437);a(2265);var n=a(4454),i=a.n(n),r=a(819);t.default=()=>(0,s.jsx)("main",{className:i().main,children:(0,s.jsx)("div",{className:i().container,children:(0,s.jsx)(r.Z,{})})})},1438:function(e){e.exports={chatContainer:"chat_chatContainer__uCE53",inputForm:"chat_inputForm__mfg3w",input:"chat_input__hTFIv",button:"chat_button__XH0Gl",messages:"chat_messages__C__xG",userMessage:"chat_userMessage__xLvbe",assistantMessage:"chat_assistantMessage__rdpnJ",codeMessage:"chat_codeMessage__djeQF"}},4454:function(e){e.exports={main:"page_main__nw1Wk",container:"page_container__jZF7q"}}},function(e){e.O(0,[78,971,69,744],function(){return e(e.s=1551)}),_N_E=e.O()}]);